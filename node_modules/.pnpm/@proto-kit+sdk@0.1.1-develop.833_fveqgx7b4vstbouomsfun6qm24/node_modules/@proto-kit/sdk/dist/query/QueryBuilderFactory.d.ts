import { TypedClass } from "@proto-kit/common";
import { Runtime, RuntimeModule, RuntimeModulesRecord } from "@proto-kit/module";
import { Protocol, ProtocolModule, ProtocolModulesRecord, State, StateMap } from "@proto-kit/protocol";
import type { QueryTransportModule } from "./StateServiceQueryModule";
export type PickByType<Type, Value> = {
    [Key in keyof Type as Type[Key] extends Value | undefined ? Key : never]: Type[Key];
};
export interface QueryGetterState<Value> {
    get: () => Promise<Value | undefined>;
}
export interface QueryGetterStateMap<Key, Value> {
    get: (key: Key) => Promise<Value | undefined>;
}
export type PickStateProperties<Type> = PickByType<Type, State<any>>;
export type PickStateMapProperties<Type> = PickByType<Type, StateMap<any, any>>;
export type MapStateToQuery<StateProperty> = StateProperty extends State<infer Value> ? QueryGetterState<Value> : never;
export type MapStateMapToQuery<StateProperty> = StateProperty extends StateMap<infer Key, infer Value> ? QueryGetterStateMap<Key, Value> : never;
export type ModuleQuery<Module> = {
    [Key in keyof PickStateMapProperties<Module>]: MapStateMapToQuery<PickStateMapProperties<Module>[Key]>;
} & {
    [Key in keyof PickStateProperties<Module>]: MapStateToQuery<PickStateProperties<Module>[Key]>;
};
export type Query<ModuleType, RuntimeModules extends Record<string, TypedClass<ModuleType>>> = {
    [Key in keyof RuntimeModules]: ModuleQuery<InstanceType<RuntimeModules[Key]>>;
};
export declare const QueryBuilderFactory: {
    fillQuery<Module>(runtimeModule: Module, queryTransportModule: QueryTransportModule): ModuleQuery<Module>;
    fromRuntime<RuntimeModules extends RuntimeModulesRecord>(runtime: Runtime<RuntimeModules>, queryTransportModule: QueryTransportModule): Query<RuntimeModule<unknown>, RuntimeModules>;
    fromProtocol<ProtocolModules extends ProtocolModulesRecord>(runtime: Protocol<ProtocolModules>, queryTransportModule: QueryTransportModule): Query<ProtocolModule<unknown>, ProtocolModules>;
};
//# sourceMappingURL=QueryBuilderFactory.d.ts.map