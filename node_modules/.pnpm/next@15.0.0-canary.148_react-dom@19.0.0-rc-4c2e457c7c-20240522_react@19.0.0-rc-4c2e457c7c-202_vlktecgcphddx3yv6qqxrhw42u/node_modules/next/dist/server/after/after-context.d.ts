import { type RequestStore } from '../../client/components/request-async-storage.external';
import type { RequestLifecycleOpts } from '../base-server';
import type { AfterTask } from './after';
export type AfterContextOpts = {
    waitUntil: RequestLifecycleOpts['waitUntil'] | undefined;
    onClose: RequestLifecycleOpts['onClose'] | undefined;
};
export declare class AfterContext {
    private waitUntil;
    private onClose;
    private requestStore;
    private runCallbacksOnClosePromise;
    private callbackQueue;
    constructor({ waitUntil, onClose }: AfterContextOpts);
    run<T>(requestStore: RequestStore, callback: () => T): T;
    after(task: AfterTask): void;
    private addCallback;
    private runCallbacksOnClose;
    private runCallbacks;
}
