{"version":3,"sources":["../../../../src/build/webpack/plugins/define-env-plugin.ts"],"sourcesContent":["import type {\n  I18NDomains,\n  NextConfigComplete,\n} from '../../../server/config-shared'\nimport type { MiddlewareMatcher } from '../../analysis/get-page-static-info'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\nimport { needsExperimentalReact } from '../../../lib/needs-experimental-react'\nimport { checkIsAppPPREnabled } from '../../../server/lib/experimental/ppr'\n\nfunction errorIfEnvConflicted(config: NextConfigComplete, key: string) {\n  const isPrivateKey = /^(?:NODE_.+)|^(?:__.+)$/i.test(key)\n  const hasNextRuntimeKey = key === 'NEXT_RUNTIME'\n\n  if (isPrivateKey || hasNextRuntimeKey) {\n    throw new Error(\n      `The key \"${key}\" under \"env\" in ${config.configFileName} is not allowed. https://nextjs.org/docs/messages/env-key-not-allowed`\n    )\n  }\n}\n\ntype BloomFilter = ReturnType<\n  import('../../../shared/lib/bloom-filter').BloomFilter['export']\n>\n\nexport interface DefineEnvPluginOptions {\n  isTurbopack: boolean\n  clientRouterFilters?: {\n    staticFilter: BloomFilter\n    dynamicFilter: BloomFilter\n  }\n  config: NextConfigComplete\n  dev: boolean\n  distDir: string\n  fetchCacheKeyPrefix: string | undefined\n  hasRewrites: boolean\n  isClient: boolean\n  isEdgeServer: boolean\n  isNodeOrEdgeCompilation: boolean\n  isNodeServer: boolean\n  middlewareMatchers: MiddlewareMatcher[] | undefined\n}\n\ninterface DefineEnv {\n  [key: string]:\n    | string\n    | string[]\n    | boolean\n    | MiddlewareMatcher[]\n    | BloomFilter\n    | Partial<NextConfigComplete['images']>\n    | I18NDomains\n}\n\ninterface SerializedDefineEnv {\n  [key: string]: string\n}\n\n/**\n * Collects all environment variables that are using the `NEXT_PUBLIC_` prefix.\n */\nexport function getNextPublicEnvironmentVariables(): DefineEnv {\n  const defineEnv: DefineEnv = {}\n  for (const key in process.env) {\n    if (key.startsWith('NEXT_PUBLIC_')) {\n      const value = process.env[key]\n      if (value != null) {\n        defineEnv[`process.env.${key}`] = value\n      }\n    }\n  }\n  return defineEnv\n}\n\n/**\n * Collects the `env` config value from the Next.js config.\n */\nfunction getNextConfigEnv(config: NextConfigComplete): DefineEnv {\n  // Refactored code below to use for-of\n  const defineEnv: DefineEnv = {}\n  const env = config.env\n  for (const key in env) {\n    const value = env[key]\n    if (value != null) {\n      errorIfEnvConflicted(config, key)\n      defineEnv[`process.env.${key}`] = value\n    }\n  }\n  return defineEnv\n}\n\n/**\n * Serializes the DefineEnv config so that it can be inserted into the code by Webpack/Turbopack, JSON stringifies each value.\n */\nfunction serializeDefineEnv(defineEnv: DefineEnv): SerializedDefineEnv {\n  const defineEnvStringified: SerializedDefineEnv = {}\n  for (const key in defineEnv) {\n    const value = defineEnv[key]\n    defineEnvStringified[key] = JSON.stringify(value)\n  }\n\n  return defineEnvStringified\n}\n\nfunction getImageConfig(\n  config: NextConfigComplete,\n  dev: boolean\n): { 'process.env.__NEXT_IMAGE_OPTS': Partial<NextConfigComplete['images']> } {\n  return {\n    'process.env.__NEXT_IMAGE_OPTS': {\n      deviceSizes: config.images.deviceSizes,\n      imageSizes: config.images.imageSizes,\n      path: config.images.path,\n      loader: config.images.loader,\n      dangerouslyAllowSVG: config.images.dangerouslyAllowSVG,\n      unoptimized: config?.images?.unoptimized,\n      ...(dev\n        ? {\n            // pass domains in development to allow validating on the client\n            domains: config.images.domains,\n            remotePatterns: config.images?.remotePatterns,\n            output: config.output,\n          }\n        : {}),\n    },\n  }\n}\n\nexport function getDefineEnv({\n  isTurbopack,\n  clientRouterFilters,\n  config,\n  dev,\n  distDir,\n  fetchCacheKeyPrefix,\n  hasRewrites,\n  isClient,\n  isEdgeServer,\n  isNodeOrEdgeCompilation,\n  isNodeServer,\n  middlewareMatchers,\n}: DefineEnvPluginOptions): SerializedDefineEnv {\n  const nextPublicEnv = getNextPublicEnvironmentVariables()\n  const nextConfigEnv = getNextConfigEnv(config)\n\n  const defineEnv: DefineEnv = {\n    // internal field to identify the plugin config\n    __NEXT_DEFINE_ENV: true,\n\n    ...nextPublicEnv,\n    ...nextConfigEnv,\n    ...(!isEdgeServer\n      ? {}\n      : {\n          EdgeRuntime:\n            /**\n             * Cloud providers can set this environment variable to allow users\n             * and library authors to have different implementations based on\n             * the runtime they are running with, if it's not using `edge-runtime`\n             */\n            process.env.NEXT_EDGE_RUNTIME_PROVIDER ?? 'edge-runtime',\n\n          // process should be only { env: {...} } for edge runtime.\n          // For ignore avoid warn on `process.emit` usage but directly omit it.\n          'process.emit': false,\n        }),\n    'process.turbopack': isTurbopack,\n    'process.env.TURBOPACK': isTurbopack,\n    // TODO: enforce `NODE_ENV` on `process.env`, and add a test:\n    'process.env.NODE_ENV':\n      dev || config.experimental.allowDevelopmentBuild\n        ? 'development'\n        : 'production',\n    'process.env.NEXT_RUNTIME': isEdgeServer\n      ? 'edge'\n      : isNodeServer\n        ? 'nodejs'\n        : '',\n    'process.env.NEXT_MINIMAL': '',\n    'process.env.__NEXT_APP_NAV_FAIL_HANDLING': Boolean(\n      config.experimental.appNavFailHandling\n    ),\n    'process.env.__NEXT_APP_ISR_INDICATOR': Boolean(\n      config.devIndicators.appIsrStatus\n    ),\n    'process.env.__NEXT_PPR': checkIsAppPPREnabled(config.experimental.ppr),\n    'process.env.__NEXT_AFTER': config.experimental.after ?? false,\n    'process.env.NEXT_DEPLOYMENT_ID': config.deploymentId || false,\n    'process.env.__NEXT_FETCH_CACHE_KEY_PREFIX': fetchCacheKeyPrefix ?? '',\n    ...(isTurbopack\n      ? {}\n      : {\n          'process.env.__NEXT_MIDDLEWARE_MATCHERS': middlewareMatchers ?? [],\n        }),\n    'process.env.__NEXT_MANUAL_CLIENT_BASE_PATH':\n      config.experimental.manualClientBasePath ?? false,\n    'process.env.__NEXT_CLIENT_ROUTER_DYNAMIC_STALETIME': JSON.stringify(\n      isNaN(Number(config.experimental.staleTimes?.dynamic))\n        ? 0\n        : config.experimental.staleTimes?.dynamic\n    ),\n    'process.env.__NEXT_CLIENT_ROUTER_STATIC_STALETIME': JSON.stringify(\n      isNaN(Number(config.experimental.staleTimes?.static))\n        ? 5 * 60 // 5 minutes\n        : config.experimental.staleTimes?.static\n    ),\n    'process.env.__NEXT_FLYING_SHUTTLE': Boolean(\n      config.experimental.flyingShuttle\n    ),\n    'process.env.__NEXT_CLIENT_ROUTER_FILTER_ENABLED':\n      config.experimental.clientRouterFilter ?? true,\n    'process.env.__NEXT_CLIENT_ROUTER_S_FILTER':\n      clientRouterFilters?.staticFilter ?? false,\n    'process.env.__NEXT_CLIENT_ROUTER_D_FILTER':\n      clientRouterFilters?.dynamicFilter ?? false,\n    'process.env.__NEXT_OPTIMISTIC_CLIENT_CACHE':\n      config.experimental.optimisticClientCache ?? true,\n    'process.env.__NEXT_MIDDLEWARE_PREFETCH':\n      config.experimental.middlewarePrefetch ?? 'flexible',\n    'process.env.__NEXT_CROSS_ORIGIN': config.crossOrigin,\n    'process.browser': isClient,\n    'process.env.__NEXT_TEST_MODE': process.env.__NEXT_TEST_MODE ?? false,\n    // This is used in client/dev-error-overlay/hot-dev-client.js to replace the dist directory\n    ...(dev && (isClient ?? isEdgeServer)\n      ? {\n          'process.env.__NEXT_DIST_DIR': distDir,\n        }\n      : {}),\n    'process.env.__NEXT_TRAILING_SLASH': config.trailingSlash,\n    'process.env.__NEXT_BUILD_INDICATOR':\n      config.devIndicators.buildActivity ?? true,\n    'process.env.__NEXT_BUILD_INDICATOR_POSITION':\n      config.devIndicators.buildActivityPosition ?? 'bottom-right',\n    'process.env.__NEXT_STRICT_MODE':\n      config.reactStrictMode === null ? false : config.reactStrictMode,\n    'process.env.__NEXT_STRICT_MODE_APP':\n      // When next.config.js does not have reactStrictMode it's enabled by default.\n      config.reactStrictMode === null ? true : config.reactStrictMode,\n    'process.env.__NEXT_OPTIMIZE_CSS':\n      (config.experimental.optimizeCss && !dev) ?? false,\n    'process.env.__NEXT_SCRIPT_WORKERS':\n      (config.experimental.nextScriptWorkers && !dev) ?? false,\n    'process.env.__NEXT_SCROLL_RESTORATION':\n      config.experimental.scrollRestoration ?? false,\n    ...getImageConfig(config, dev),\n    'process.env.__NEXT_ROUTER_BASEPATH': config.basePath,\n    'process.env.__NEXT_STRICT_NEXT_HEAD':\n      config.experimental.strictNextHead ?? true,\n    'process.env.__NEXT_HAS_REWRITES': hasRewrites,\n    'process.env.__NEXT_CONFIG_OUTPUT': config.output,\n    'process.env.__NEXT_I18N_SUPPORT': !!config.i18n,\n    'process.env.__NEXT_I18N_DOMAINS': config.i18n?.domains ?? false,\n    'process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE':\n      config.skipMiddlewareUrlNormalize,\n    'process.env.__NEXT_EXTERNAL_MIDDLEWARE_REWRITE_RESOLVE':\n      config.experimental.externalMiddlewareRewritesResolve ?? false,\n    'process.env.__NEXT_MANUAL_TRAILING_SLASH':\n      config.skipTrailingSlashRedirect,\n    'process.env.__NEXT_HAS_WEB_VITALS_ATTRIBUTION':\n      (config.experimental.webVitalsAttribution &&\n        config.experimental.webVitalsAttribution.length > 0) ??\n      false,\n    'process.env.__NEXT_WEB_VITALS_ATTRIBUTION':\n      config.experimental.webVitalsAttribution ?? false,\n    'process.env.__NEXT_LINK_NO_TOUCH_START':\n      config.experimental.linkNoTouchStart ?? false,\n    'process.env.__NEXT_ASSET_PREFIX': config.assetPrefix,\n    ...(isNodeOrEdgeCompilation\n      ? {\n          // Fix bad-actors in the npm ecosystem (e.g. `node-formidable`)\n          // This is typically found in unmaintained modules from the\n          // pre-webpack era (common in server-side code)\n          'global.GENTLY': false,\n        }\n      : undefined),\n    ...(isNodeOrEdgeCompilation\n      ? {\n          'process.env.__NEXT_EXPERIMENTAL_REACT':\n            needsExperimentalReact(config),\n        }\n      : undefined),\n  }\n  const serializedDefineEnv = serializeDefineEnv(defineEnv)\n\n  if (!dev && Boolean(config.experimental.flyingShuttle)) {\n    // we delay inlining these values until after the build\n    // with flying shuttle enabled so we can update them\n    // without invalidating entries\n    for (const key in nextPublicEnv) {\n      if (key in nextConfigEnv) {\n        continue\n      }\n      serializedDefineEnv[key] = key\n    }\n  }\n\n  return serializedDefineEnv\n}\n\nexport function getDefineEnvPlugin(options: DefineEnvPluginOptions) {\n  return new webpack.DefinePlugin(getDefineEnv(options))\n}\n"],"names":["getDefineEnv","getDefineEnvPlugin","getNextPublicEnvironmentVariables","errorIfEnvConflicted","config","key","isPrivateKey","test","hasNextRuntimeKey","Error","configFileName","defineEnv","process","env","startsWith","value","getNextConfigEnv","serializeDefineEnv","defineEnvStringified","JSON","stringify","getImageConfig","dev","deviceSizes","images","imageSizes","path","loader","dangerouslyAllowSVG","unoptimized","domains","remotePatterns","output","isTurbopack","clientRouterFilters","distDir","fetchCacheKeyPrefix","hasRewrites","isClient","isEdgeServer","isNodeOrEdgeCompilation","isNodeServer","middlewareMatchers","nextPublicEnv","nextConfigEnv","__NEXT_DEFINE_ENV","EdgeRuntime","NEXT_EDGE_RUNTIME_PROVIDER","experimental","allowDevelopmentBuild","Boolean","appNavFailHandling","devIndicators","appIsrStatus","checkIsAppPPREnabled","ppr","after","deploymentId","manualClientBasePath","isNaN","Number","staleTimes","dynamic","static","flyingShuttle","clientRouterFilter","staticFilter","dynamicFilter","optimisticClientCache","middlewarePrefetch","crossOrigin","__NEXT_TEST_MODE","trailingSlash","buildActivity","buildActivityPosition","reactStrictMode","optimizeCss","nextScriptWorkers","scrollRestoration","basePath","strictNextHead","i18n","skipMiddlewareUrlNormalize","externalMiddlewareRewritesResolve","skipTrailingSlashRedirect","webVitalsAttribution","length","linkNoTouchStart","assetPrefix","undefined","needsExperimentalReact","serializedDefineEnv","options","webpack","DefinePlugin"],"mappings":"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"}